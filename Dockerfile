ARG PYTHON_VERSION=3.11

FROM python:${PYTHON_VERSION}
RUN apt update && apt upgrade -y \
  && rm -rf /var/lib/apt/lists/*

RUN apt-get update

COPY tilebench tilebench
COPY pyproject.toml pyproject.toml
COPY README.md README.md
COPY CHANGES.md CHANGES.md
COPY LICENSE LICENSE

RUN pip install . --no-cache-dir --upgrade

ENV GDAL_INGESTED_BYTES_AT_OPEN=32768
ENV GDAL_DISABLE_READDIR_ON_OPEN=EMPTY_DIR
ENV GDAL_HTTP_MERGE_CONSECUTIVE_RANGES=YES
ENV GDAL_HTTP_MULTIPLEX=YES
ENV GDAL_HTTP_VERSION=2
ENV VSI_CACHE=TRUE
ENV VSI_CACHE_SIZE=536870912
